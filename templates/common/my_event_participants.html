{% extends "common/base.html" %}
{% load static %}

{% block content %}
    <div class="container my-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h1 class="h4 mb-0">{{ event.title }} — Participants ({{ participants_count }})</h1>
            <div class="d-flex gap-2">
                <button type="button" class="btn btn-outline-secondary" onclick="history.back()">Back</button>
                <a href="{% url 'event_details' event.pk %}" class="btn btn-outline-primary">Details</a>
            </div>
        </div>

        {% if participants_count %}
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped table-hover align-middle participants-table">
                            
                            <thead class="table-primary">
                            <tr>
                                <th class="text-nowrap" scope="col">#</th>
                                <th class="text-nowrap" scope="col">Participant</th>
                                <th class="text-nowrap" scope="col">Contact email</th>
                                <th class="text-nowrap" scope="col">Phone</th>
                                <th class="text-nowrap" scope="col" style="min-width:260px;">Questions</th>
                                <th class="text-nowrap" scope="col">Date Joined</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for p in participants %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ p.user.profile.full_name|default:p.user.email }}</td>
                                    
                                    <td>{{ p.contact_email|default:p.user.email|default:"—" }}</td>
                                    <td>{{ p.contact_phone|default:"—" }}</td>
                                    <td class="text-break">{{ p.questions|default:"—"|linebreaksbr }}</td>
                                    <td>{{ p.date_joined|date:"Y-m-d H:i" }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
        {% else %}
            <div class="alert alert-info">No participants!</div>
        {% endif %}
    </div>


{% endblock %}
